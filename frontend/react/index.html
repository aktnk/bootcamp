<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reactでシングルページアプリケーションを書こう | IIJ Bootcamp</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Reactでシングルページアプリケーションを書こう">
    
    <link rel="preload" href="/bootcamp/assets/css/0.styles.08f6960e.css" as="style"><link rel="preload" href="/bootcamp/assets/js/app.62a3d345.js" as="script"><link rel="preload" href="/bootcamp/assets/js/2.f590af91.js" as="script"><link rel="preload" href="/bootcamp/assets/js/9.2792b898.js" as="script"><link rel="preload" href="/bootcamp/assets/js/13.84557f0a.js" as="script"><link rel="preload" href="/bootcamp/assets/js/12.3f056208.js" as="script"><link rel="prefetch" href="/bootcamp/assets/js/10.2bc94a00.js"><link rel="prefetch" href="/bootcamp/assets/js/11.6fdb816d.js"><link rel="prefetch" href="/bootcamp/assets/js/14.94ced0a2.js"><link rel="prefetch" href="/bootcamp/assets/js/15.68f6fc7d.js"><link rel="prefetch" href="/bootcamp/assets/js/16.d346ef33.js"><link rel="prefetch" href="/bootcamp/assets/js/17.157aec02.js"><link rel="prefetch" href="/bootcamp/assets/js/18.bfbff2d0.js"><link rel="prefetch" href="/bootcamp/assets/js/19.6042adc3.js"><link rel="prefetch" href="/bootcamp/assets/js/20.1d07f5b7.js"><link rel="prefetch" href="/bootcamp/assets/js/21.643ef0bd.js"><link rel="prefetch" href="/bootcamp/assets/js/22.33afd5e6.js"><link rel="prefetch" href="/bootcamp/assets/js/23.78151ddb.js"><link rel="prefetch" href="/bootcamp/assets/js/24.8c8abf5e.js"><link rel="prefetch" href="/bootcamp/assets/js/25.99e70852.js"><link rel="prefetch" href="/bootcamp/assets/js/26.d7d5b768.js"><link rel="prefetch" href="/bootcamp/assets/js/27.a5c2f1f8.js"><link rel="prefetch" href="/bootcamp/assets/js/28.61e354de.js"><link rel="prefetch" href="/bootcamp/assets/js/29.38e6da29.js"><link rel="prefetch" href="/bootcamp/assets/js/3.4f211774.js"><link rel="prefetch" href="/bootcamp/assets/js/30.f96958e1.js"><link rel="prefetch" href="/bootcamp/assets/js/31.cf1e98f0.js"><link rel="prefetch" href="/bootcamp/assets/js/32.1245219c.js"><link rel="prefetch" href="/bootcamp/assets/js/33.667d5a3e.js"><link rel="prefetch" href="/bootcamp/assets/js/34.62f14843.js"><link rel="prefetch" href="/bootcamp/assets/js/35.a941af32.js"><link rel="prefetch" href="/bootcamp/assets/js/36.56c8d545.js"><link rel="prefetch" href="/bootcamp/assets/js/37.3d8f3e9e.js"><link rel="prefetch" href="/bootcamp/assets/js/38.40419498.js"><link rel="prefetch" href="/bootcamp/assets/js/39.96493f74.js"><link rel="prefetch" href="/bootcamp/assets/js/4.36482b7b.js"><link rel="prefetch" href="/bootcamp/assets/js/40.184d7311.js"><link rel="prefetch" href="/bootcamp/assets/js/41.fe5ca352.js"><link rel="prefetch" href="/bootcamp/assets/js/42.84ca0f64.js"><link rel="prefetch" href="/bootcamp/assets/js/43.ff0b6297.js"><link rel="prefetch" href="/bootcamp/assets/js/44.b3248c17.js"><link rel="prefetch" href="/bootcamp/assets/js/45.2ea732d1.js"><link rel="prefetch" href="/bootcamp/assets/js/46.8997d390.js"><link rel="prefetch" href="/bootcamp/assets/js/47.f747ca2a.js"><link rel="prefetch" href="/bootcamp/assets/js/48.b60024f1.js"><link rel="prefetch" href="/bootcamp/assets/js/49.2e2a7618.js"><link rel="prefetch" href="/bootcamp/assets/js/5.da92d4dd.js"><link rel="prefetch" href="/bootcamp/assets/js/50.c2758634.js"><link rel="prefetch" href="/bootcamp/assets/js/6.01bbaa96.js"><link rel="prefetch" href="/bootcamp/assets/js/7.a72d564c.js"><link rel="prefetch" href="/bootcamp/assets/js/8.98ab620a.js">
    <link rel="stylesheet" href="/bootcamp/assets/css/0.styles.08f6960e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bootcamp/" class="home-link router-link-active"><!----> <span class="site-name">IIJ Bootcamp</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/iij/bootcamp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/iij/bootcamp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Reactでシングルページアプリケーションを書こう</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bootcamp/frontend/react/#下準備" class="sidebar-link">下準備</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#手順" class="sidebar-link">手順</a></li></ul></li><li><a href="/bootcamp/frontend/react/#始めに" class="sidebar-link">始めに</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#達成目標" class="sidebar-link">達成目標</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#本講義の前提" class="sidebar-link">本講義の前提</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#この資料のお約束" class="sidebar-link">この資料のお約束</a></li></ul></li><li><a href="/bootcamp/frontend/react/#reactとは" class="sidebar-link">Reactとは</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#シングルページアプリケーションとは" class="sidebar-link">シングルページアプリケーションとは</a></li></ul></li><li><a href="/bootcamp/frontend/react/#reactハンズオン" class="sidebar-link">Reactハンズオン</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#hello-world" class="sidebar-link">Hello World</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#コンポーネントを作成してみる" class="sidebar-link">コンポーネントを作成してみる</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#コンポーネントの機能-小要素へのデータの共有-props" class="sidebar-link">コンポーネントの機能 - 小要素へのデータの共有 : Props</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#コンポーネントの機能-内部データストア-state" class="sidebar-link">コンポーネントの機能 - 内部データストア : State</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#コンポーネントの機能-ライフサイクル管理-lifecycle" class="sidebar-link">コンポーネントの機能 - ライフサイクル管理: LifeCycle</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#hooksを導入する" class="sidebar-link">Hooksを導入する</a></li><li class="sidebar-sub-header"><a href="/bootcamp/frontend/react/#reactアプリケーションをデプロイする" class="sidebar-link">Reactアプリケーションをデプロイする</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><table><tr><td>このハンズオンでやること</td><td>Reactでシングルページアプリケーションを書こう</td></tr> <tr><td>想定時間</td><td>2h</td></tr> <tr><td>前提知識・用語</td><td>特になし</td></tr></table> <h1 id="page-frontmatter-title"><a href="#page-frontmatter-title" class="header-anchor">#</a> Reactでシングルページアプリケーションを書こう</h1> <h2 id="下準備"><a href="#下準備" class="header-anchor">#</a> 下準備</h2> <p>講義を受講する前にコンテナイメージのpullと起動をしておくことをお勧めしています。
また、Dockerの実行環境があることを前提として本講義を進めます。</p> <h3 id="手順"><a href="#手順" class="header-anchor">#</a> 手順</h3> <ol><li>ハンズオン用のDockerイメージをpullしてくる</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># やや重たいので注意してください</span>
$ docker pull ryusa/bootcamp-react:2021
</code></pre></div><ol start="2"><li>コンテナを起動する</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># コンテナを起動する</span>
$ docker run --name bootcamp-react -itd -p <span class="token number">3000</span>:3000 ryusa/bootcamp-react:2021
</code></pre></div><ol start="3"><li>アプリケーションの起動チェック</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># コンテナの中にアタッチする</span>
$ docker <span class="token builtin class-name">exec</span> -it bootcamp-react <span class="token function">bash</span>
<span class="token comment"># Reactの開発用サーバーを起動する</span>
❯ <span class="token function">npm</span> start
<span class="token comment"># ...</span>
<span class="token comment"># いろんなログが流れる</span>
</code></pre></div><ol start="4"><li>動作チェック</li></ol> <p>ホストマシンから適当なブラウザ(※IEを除く)から<a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">localhost:3000<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>にアクセスし、Welcomeページが表示されることを確認してください。</p> <p><img src="/bootcamp/assets/img/welcome.af730a74.png" alt="welcome"></p> <h2 id="始めに"><a href="#始めに" class="header-anchor">#</a> 始めに</h2> <p>本講義ではReactの動作原理を学びながら簡単なシングルページアプリケーションの作成を通して、今後の技術的な選択肢を増やすことを目的としています。</p> <h3 id="達成目標"><a href="#達成目標" class="header-anchor">#</a> 達成目標</h3> <ul><li>フロントエンド開発を経験する</li> <li>コンポーネントベース開発を経験する</li> <li>React開発の流れを理解する</li></ul> <h3 id="本講義の前提"><a href="#本講義の前提" class="header-anchor">#</a> 本講義の前提</h3> <p>本講義ではプログラム言語共通の制御構文や概念、たとえばif文や型など、の解説は行いません。そのため、受講者は何らかのプログラミング言語で簡単な制御構文が書けることを前提とさせてください。</p> <h3 id="この資料のお約束"><a href="#この資料のお約束" class="header-anchor">#</a> この資料のお約束</h3> <p>💻 は自分で操作する箇所を示しています。 また<code>$</code>はホストマシンのプロンプトを意味し、<code>❯</code>はコンテナ内部でのプロンプトを意味します。</p> <p>たとえば下記の通りです。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># ホストマシン上で git clone git@github.com:iij/bootcamp.git を実行する</span>
$ <span class="token function">git</span> clone git@github.com:iij/bootcamp.git

<span class="token comment"># コンテナ上で curl localhost:3000 を実行する</span>
❯ <span class="token function">curl</span> localhost:3000
</code></pre></div><h2 id="reactとは"><a href="#reactとは" class="header-anchor">#</a> Reactとは</h2> <p>Reactは、もともとFacebook社が開発しているWebユーザーインタフェースのためのフレームワークです。2021年6月現在のGoogleトレンドをみる限りフロントエンドフレームワークとしてのシェアは世界一位となっており、多種多様な場所で利用されています。<br>
IIJでもいくつかの製品のフロントエンドとしてReactが採用されています。</p> <p>公式サイト：<a href="https://ja.reactjs.org/" target="_blank" rel="noopener noreferrer">React - ユーザインターフェース構築のためのJavaScriptライブラリ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>ReactはVueやAngularと同じくコンポーネントベースでWebUIを実装していくフレームワークです。細かくコンポーネントを分離することでアトミックデザインなUIを実装しやすくなります。
また型を持つTypeScriptとの相性も非常に良いため、開発者からの評価も高いです。</p> <div class="custom-block tip"><p class="custom-block-title">Create React App</p> <p>Reactを始めるための方法としては、いくつかの方法があります。</p> <ul><li>Reactの基礎を体験したい = オンラインサービスを使う
<ul><li><a href="https://reactjs.org/redirect-to-codepen/hello-world" target="_blank" rel="noopener noreferrer">CodePen<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://codesandbox.io/s/new" target="_blank" rel="noopener noreferrer">CodeSandbox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://glitch.com/edit/#!/remix/starter-react-template" target="_blank" rel="noopener noreferrer">Glitch<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>既存のHTMLページの中にReact埋め込みたい = 下記のチュートリアル
<ul><li><a href="https://reactjs.org/docs/add-react-to-a-website.html" target="_blank" rel="noopener noreferrer">Add React to a WebSite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>フルにReactを使ってアプリケーションを作りたい = Create React App
<ul><li><a href="https://facebook.github.io/create-react-app/docs/getting-started" target="_blank" rel="noopener noreferrer">Create React App<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul> <p>このハンズオンでは、最初からReactを使うことを想定してCreate React App を使ったプロジェクトひな型を作成しています。詳細は<a href="https://github.com/iij/bootcamp/blob/master/src/frontend/react/Dockerfile" target="_blank" rel="noopener noreferrer">Dockerfile<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を参考にしてください。</p></div> <h3 id="シングルページアプリケーションとは"><a href="#シングルページアプリケーションとは" class="header-anchor">#</a> シングルページアプリケーションとは</h3> <p>シングルページアプリケーション(以下SPA)とはフロントエンドアプリケーションの構成のひとつです。</p> <p><a href="https://ja.wikipedia.org/wiki/%E3%82%B7%E3%83%B3%E3%82%B0%E3%83%AB%E3%83%9A%E3%83%BC%E3%82%B8%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3" target="_blank" rel="noopener noreferrer">シングルページアプリケーション | Wikipedia<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>特徴として</p> <ul><li>HTMLとCSS、そしてJavaScriptのファイルのみで構成
<ul><li>HTMLは単一</li> <li>サーバーとの通信は原則API経由</li></ul></li> <li>DOMの操作や変更はJavaScriptで実施
<ul><li>物理DOMの操作と比べて軽量</li> <li>滑らかな画面遷移によるユーザー体験</li></ul></li></ul> <p>といったものが挙げられます。<code>create-react-app</code>で構成したReactプロジェクトはデフォルトでSPAがビルドできるようになっています。Reactプロジェクトをビルドすることで最終成果物である「HTML」「CSS」「JavaScript」が生成され、それらをNGINXなどのWebサーバーで配信することができます。</p> <p>なおすべてのフロントエンドアプリケーションがSPAであるわけではなく、SPAでないものとしてSSR(=サーバサイドレンダリング)が挙げられます。これはサーバー側でユーザーのリクエストに合わせてDOMを動的に構築し、HTMLとしてユーザーに配信する構成です。Angular Universalなどではこの方式でアプリケーションを配信します。</p> <h2 id="reactハンズオン"><a href="#reactハンズオン" class="header-anchor">#</a> Reactハンズオン</h2> <p>実際にReactに触れてみましょう。本講義ではTypeScriptを使ってReactを書いていきます。</p> <h3 id="hello-world"><a href="#hello-world" class="header-anchor">#</a> Hello World</h3> <p>Reactの開発サーバは、ソースコードの変更を検知してその変更をブラウザに伝えてくれます。
さっそくひとつやってみましょう。</p> <p>これから先、ファイルを編集することになるので別のシェルを取得して進めてください。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 別のターミナルでシェルを取得しておく</span>
$ docker <span class="token builtin class-name">exec</span> -it bootcamp-react <span class="token function">bash</span>
❯ 
</code></pre></div><p>💻 src/App.tsxを開き下記の通りに編集してください。</p> <div class="language-tsx extra-class"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token string">'./App.css'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello World!!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre></div><p>編集して保存するとブラウザが自動的にリロードされ、下記のような画面に変わります。</p> <p><img src="/bootcamp/assets/img/helloworld.95e6af6b.png" alt="helloworld"></p> <div class="custom-block warning"><p class="custom-block-title">自動的にリロードされない場合</p> <p>リロードがうまくいかない場合、開発用サーバーでエラーが起きてしまっている可能性があります。その場合は開発用サーバーを一度止め、再起動してあげてください。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>❯ <span class="token function">npm</span> start
</code></pre></div></div> <h4 id="チェックポイント"><a href="#チェックポイント" class="header-anchor">#</a> チェックポイント</h4> <ul><li>ReactでHello Worldを実施した</li></ul> <h3 id="コンポーネントを作成してみる"><a href="#コンポーネントを作成してみる" class="header-anchor">#</a> コンポーネントを作成してみる</h3> <p>ReactはUIの部品をコンポーネントという単位に分割することで、ロジックやスタイルなどの再利用性を高めて実装を行います。</p> <div class="custom-block tip"><p class="custom-block-title">なぜコンポーネントを使うのか</p> <p>ReactではなくVueですが、こちらの記事が非常にわかりやすい例です。VueとReactともにコンポーネントベースのフレームワークですので、根幹は一緒です。</p> <p>気になる人は読んでみてください。</p> <p><a href="https://qiita.com/Yametaro/items/e8cb39b1a20b762bfafa" target="_blank" rel="noopener noreferrer">ワイ「何でそんな小っさいコンポーネント作ってるん？ｗ」 | Qiita<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>まず小さなコンポーネントを作ってみましょう。コンポーネントを記述する方法はいくつかありますが、まずクラスベースのコンポーネントを作成してみます。</p> <p>💻 src/Note.tsxを作成し、下記の通り編集してください。</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// interface: TypeScriptにおけるインタフェース(抽象型)</span>
<span class="token keyword">interface</span> <span class="token class-name">NoteState</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">NoteProps</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Note</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span>NoteProps<span class="token punctuation">,</span> NoteState<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Component! Component!! Component!!!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>💻 さらにsrc/App.tsxがNote.tsxを使うように修正してください。</p> <div class="language-tsx extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token string">'./App.css'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Note <span class="token keyword">from</span> <span class="token string">'./Note'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre></div><p>さあ、<a href="http://localhost:3000" target="_blank" rel="noopener noreferrer">localhost:3000<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>にアクセスするとブラウザに表示されている内容が変化したと思います。</p> <p><img src="/bootcamp/assets/img/componentcomponentcomponent.65127309.png" alt="componentcomponentcomponent"></p> <p>このようにReactではコンポーネントというUI部品を組み合わせることでデザイン、UIを作成していきます。</p> <h4 id="チェックポイント-2"><a href="#チェックポイント-2" class="header-anchor">#</a> チェックポイント</h4> <ul><li>クラスベースコンポーネントの書き方を学んだ</li> <li>コンポーネントの使い方を学んだ</li></ul> <h3 id="コンポーネントの機能-小要素へのデータの共有-props"><a href="#コンポーネントの機能-小要素へのデータの共有-props" class="header-anchor">#</a> コンポーネントの機能 - 小要素へのデータの共有 : Props</h3> <p><code>Note</code> コンポーネントを作成しましたが、今のままでは&quot;Component! Component!! Component!!!&quot;と叫ぶだけのコンポーネントで再利用性が悪いです。</p> <p>他も文字を叫ぶことができるように、叫ぶ文字を外から渡してあげることができるようにしましょう。</p> <p>💻 src/Note.tsxを下記のように修正してみましょう。</p> <div class="language-tsx extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">NoteState</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">NoteProps</span> <span class="token punctuation">{</span>
  counter<span class="token operator">:</span> <span class="token builtin">number</span>
  word<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Note</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span>NoteProps<span class="token punctuation">,</span> NoteState<span class="token operator">&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">// ES6から導入されたアロー関数</span>
  <span class="token comment">// https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Functions/Arrow_functions</span>
  <span class="token comment">// (3, &quot;Component&quot;) =&gt; &quot;Component! Component!! Component!!!&quot;</span>
  <span class="token function-variable function">constructWord</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">counter<span class="token operator">:</span> number<span class="token punctuation">,</span> word<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> words <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">Array</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token operator">:</span> number<span class="token punctuation">,</span> i<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> words <span class="token operator">+=</span> word <span class="token operator">+</span> <span class="token string">&quot;!&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> words<span class="token punctuation">.</span><span class="token function">trimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">constructWord</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>counter<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>💻 src/App.tsxを修正してください。</p> <div class="language-tsx extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token string">'./App.css'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Note <span class="token keyword">from</span> <span class="token string">'./Note'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">counter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Component&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">counter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">}</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Hoge&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">counter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">3</span><span class="token punctuation">}</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Huga&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre></div><p>ここまで修正すると、下記の通りにブラウザの表示が変わります。</p> <p><img src="/bootcamp/assets/img/props.40ab6d33.png" alt="props"></p> <p>親コンポーネントからデータを注入できるように<code>props</code>を適切に定義することで、コンポーネントの再利用性をあげることができます。
注意が必要なこととして<code>props</code>はReadonlyなため、<code>props</code>の中身を書き換えたりすることはできません。</p> <h4 id="チェックポイント-3"><a href="#チェックポイント-3" class="header-anchor">#</a> チェックポイント</h4> <ul><li>コンポーネントにおける<code>Props</code>について学んだ</li> <li>コンポーネントの親子間のパラメータの受け渡し方を学んだ</li></ul> <h3 id="コンポーネントの機能-内部データストア-state"><a href="#コンポーネントの機能-内部データストア-state" class="header-anchor">#</a> コンポーネントの機能 - 内部データストア : State</h3> <p><code>props</code>フィールドを通じてコンポーネント間のデータの受け渡しはできましたが、ユーザーからの入力や外部から取得した情報はどのように保存するべきでしょうか？
コンポーネントにはStateというデータの保存する機構が付属されています。試しに、ユーザーがボタンを押した数だけ叫ぶ回数を増やすように実装してみましょう。</p> <p>💻 src/Note.tsxを下記の通りに修正してください。</p> <div class="language-tsx extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">NoteState</span> <span class="token punctuation">{</span>
  counter<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">NoteProps</span> <span class="token punctuation">{</span>
  word<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Note</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span>NoteProps<span class="token punctuation">,</span> NoteState<span class="token operator">&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token operator">:</span> NoteProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token comment">// Stateの初期化</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      counter<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// クリック時のハンドラー</span>
  <span class="token function-variable function">onClickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// StateをsetStateメソッド経由で更新</span>
    <span class="token comment">// setStateでStateを更新するとDOMの再レンダリングが行われます</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      counter<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// (3, &quot;Component&quot;) =&gt; &quot;Component! Component!! Component!!!&quot;</span>
  <span class="token function-variable function">constructWord</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">counter<span class="token operator">:</span> number<span class="token punctuation">,</span> word<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> words <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">Array</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token operator">:</span> number<span class="token punctuation">,</span> i<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> words <span class="token operator">+=</span> word <span class="token operator">+</span> <span class="token string">&quot;!&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> words<span class="token punctuation">.</span><span class="token function">trimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token comment">/* ボタンをクリックされたらclick()メソッドが発火し、Stateが更新される */</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClickHandler<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          Click me!!
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token comment">/* Stateのカウンタの数だけ叫ぶ */</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">constructWord</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>💻 さらに下記の通りにsrc/App.tsxを修正してください。</p> <div class="language-tsx extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token string">'./App.css'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Note <span class="token keyword">from</span> <span class="token string">'./Note'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Component&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Hoge&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Huga&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre></div><p>ここまで修正すると下記の通りになります。</p> <p><img src="/bootcamp/assets/img/state.687fe742.png" alt="state"></p> <p>Stateはコンポーネントの内部でのみ生きているデータベースのようなものです。Stateを<code>setState</code>メソッド経由で更新を行うと、関連するコンポーネントやDOMが自動で更新されます。</p> <p>実際に&quot;Click me!!&quot;のボタンをクリックしてみてください。</p> <h4 id="チェックポイント-4"><a href="#チェックポイント-4" class="header-anchor">#</a> チェックポイント</h4> <ul><li>Stateを利用してコンポーネント内部で使えるローカルストアを作成できる</li> <li><code>setState</code> メソッドでStateを更新するとコンポーネントが自動でリロードされる</li></ul> <div class="custom-block tip"><p class="custom-block-title">Redux</p> <p>Stateを利用することで、単一のコンポーネントでデータを保存できることがわかりました。しかし認証やフォームデータなど複数のコンポーネントを跨ってグローバルに書き込みを行いたい場合もあります。またStateをもっと複雑に利用したいケースもでてきます。</p> <p>その場合はReduxというモジュールを使うと良いでしょう。Reduxはアプリケーションの状態を管理するためのモジュールでReactと親和性が非常に高いためよく利用されます。</p> <p>ただしReduxは扱いに癖があり、ハンズオンなどの短い時間での導入が難しいためこのハンズオンでは紹介にとどめておきます。</p> <p>詳しくはこちら &gt; <a href="https://react-redux.js.org/introduction/quick-start" target="_blank" rel="noopener noreferrer">React Redux<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h3 id="コンポーネントの機能-ライフサイクル管理-lifecycle"><a href="#コンポーネントの機能-ライフサイクル管理-lifecycle" class="header-anchor">#</a> コンポーネントの機能 - ライフサイクル管理: LifeCycle</h3> <p>少しコンポーネントの複雑な機能について触れてみましょう。今まではコンポーネントそのものに注力しましたが、ここではコンポーネントの作成の方法に注視してみましょう。</p> <p>コンポーネントの中には<a href="https://developer.mozilla.org/ja/docs/Web/API/WebSockets_API" target="_blank" rel="noopener noreferrer">WebSocket<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>や<a href="https://developer.mozilla.org/ja/docs/Web/API/Server-sent_events/Using_server-sent_events" target="_blank" rel="noopener noreferrer">HTTP SSE<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>を利用した購読を行うものも多々あると思います。<br>
多くのWebサイトで「画面の初期表示のタイミングで外部からデータを取得して画面に表示する」というケースを見かけます。この機能はコンポーネントのライフサイクルを利用することで実現できます。実装してみましょう！</p> <p>💻 src/Note.tsxを下記のように修正します。</p> <div class="language-tsx extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">NoteState</span> <span class="token punctuation">{</span>
  counter<span class="token operator">:</span> <span class="token builtin">number</span>
  isLoaded<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token comment">// コンポーネントのロードステータス</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">NoteProps</span> <span class="token punctuation">{</span>
  word<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// ただ時間待ちするだけのタスク</span>
<span class="token keyword">const</span> <span class="token function-variable function">someHeavyTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2秒後に引数として渡された関数`handler`がキックされます</span>
  <span class="token comment">// 処理時に外から渡されたサブルーチンを実行することをコールバックと呼びます</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Note</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component<span class="token operator">&lt;</span>NoteProps<span class="token punctuation">,</span> NoteState<span class="token operator">&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token operator">:</span> NoteProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
      counter<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      isLoaded<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// 初期ではロード中扱い</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// DOMツリーにコンポーネントが追加された直後に呼び出されるメソッド</span>
  <span class="token comment">// React.Componentに定義されているメソッドです</span>
  <span class="token function-variable function">componentDidMount</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">someHeavyTask</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        isLoaded<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">onClickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      counter<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function-variable function">constructWord</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">counter<span class="token operator">:</span> number<span class="token punctuation">,</span> word<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> words <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">Array</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token operator">:</span> number<span class="token punctuation">,</span> i<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> words <span class="token operator">+=</span> word <span class="token operator">+</span> <span class="token string">&quot;!&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> words<span class="token punctuation">.</span><span class="token function">trimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token keyword">const</span> component <span class="token operator">=</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClickHandler<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          Click me!!
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">constructWord</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">// StateのisLoadedがfalseの場合、&quot;Loading...&quot;が表示されます</span>
    <span class="token keyword">const</span> note <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isLoaded <span class="token operator">?</span> component <span class="token operator">:</span> loading
    <span class="token keyword">return</span> note
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>一瞬&quot;Loading...&quot;という文字列が見えた瞬間、画面表示されるようになったと思います。</p> <p><img src="/bootcamp/assets/img/componentdidmount.57ef2d3e.gif" alt="componentdidmount"></p> <p>初めて出てきた<code>componentDidMount</code>メソッドは<code>React.Component</code>で定義されているメソッドで、ブラウザ上にコンポーネントが描画された直後に走るメソッドです。</p> <p>Reactのコンポーネントは<code>componentDidMount</code>のようにいくつかのライフサイクル用のメソッドが用意されています。
これらのライフサイクルメソッドを利用することでコンポーネントの初期化や後処理を定義できます。</p> <p><a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" rel="noopener noreferrer">React lifecycle methods diagram<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>それぞれのタイミングで実施したい処理があれば、それぞれのメソッドの中に実装してあげると良いでしょう。</p> <p>詳しくはこちら &gt; <a href="https://ja.reactjs.org/docs/state-and-lifecycle.html" target="_blank" rel="noopener noreferrer">state とライフサイクル | React Docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="チェックポイント-5"><a href="#チェックポイント-5" class="header-anchor">#</a> チェックポイント</h4> <ul><li>コンポーネントにライフサイクルがあることを理解した</li> <li>ライフサイクルに合わせてフックを作成することができた</li></ul> <h3 id="hooksを導入する"><a href="#hooksを導入する" class="header-anchor">#</a> Hooksを導入する</h3> <p>Reactのコンポーネントを表現する方法としてクラスベースなやり方を見てきました。<br>
クラスベースなコンポーネントは便利な一方でライフサイクルが読み取りにくくなる傾向にあり、複雑なコンポーネントになるほどメンテナンス性が悪くなりがちです。</p> <p>元に、最初はシンプルだった<code>Note</code>コンポーネントもだいぶ大きくなりライフサイクルが入り乱れわかりにくくなってしまいました。(そうなるように書いてもらった、のですが……) <code>Note</code>コンポーネントのライフサイクルの全体像を眺めるには、コンストラクタと<code>componentDidMount</code>、そして<code>render</code>とを行ったり来たりする必要があります。スマートではないですね。</p> <p>ReactにはReact Hooksという機能が存在しており、これは最初に紹介した関数型コンポーネントに簡単なライフサイクルの管理とステートの保持の機能を接続することができるものです。</p> <p>詳細：<a href="https://ja.reactjs.org/docs/hooks-intro.html" target="_blank" rel="noopener noreferrer">https://ja.reactjs.org/docs/hooks-intro.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>実際にReact Hooksで今までの実装を再実装してみましょう！</p> <p>💻 新たにsrc/NewNote.tsxを作成し、下記の通り記述してください。</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useEffect<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">NoteProps</span> <span class="token punctuation">{</span>
  word<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">someHeavyTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function-variable function">handler</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 関数型コンポーネントとして定義します</span>
<span class="token comment">// ライフサイクルは基本的に「上から下」に流れていきます</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Note</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token operator">:</span> NoteProps</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// Stateはシンプルに`useState`で定義します</span>
  <span class="token comment">// 第一返値にStateそのもの、第二返値にStateの更新トリガーが入ります</span>
  <span class="token comment">// 更新トリガーを経由してStateを更新することで後述の`useEffect`を呼び出すことになります</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>counter<span class="token punctuation">,</span> setCounter<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isLoaded<span class="token punctuation">,</span> setIsLoaded<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>

  <span class="token comment">// 副作用フック</span>
  <span class="token comment">// componentDidMountなどに相当している挙動をするものです</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">someHeavyTask</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setIsLoaded</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 返り値にコールバック関数を指定することで、componentWillUnMountに相当する挙動を行うことができます</span>
    <span class="token comment">// たとえば、WebSocketの破棄などを指定することが多いです</span>
    <span class="token comment">// return () =&gt; FooBar</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">const</span> <span class="token function-variable function">onClickHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setCounter</span><span class="token punctuation">(</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> <span class="token function-variable function">constructWord</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">counter<span class="token operator">:</span> number<span class="token punctuation">,</span> word<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> words <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">Array</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_<span class="token operator">:</span> number<span class="token punctuation">,</span> i<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> words <span class="token operator">+=</span> word <span class="token operator">+</span> <span class="token string">&quot;!&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> words<span class="token punctuation">.</span><span class="token function">trimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> loading <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token keyword">const</span> component <span class="token operator">=</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onClickHandler<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        Click me!!
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token function">constructWord</span><span class="token punctuation">(</span>counter<span class="token punctuation">,</span> props<span class="token punctuation">.</span>word<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">// 関数型コンポーネントなのでDOMを返却するだけ</span>
  <span class="token keyword">return</span> isLoaded <span class="token operator">?</span> component <span class="token operator">:</span> loading  
<span class="token punctuation">}</span>
</code></pre></div><p>💻 src/App.tsxでNoteのimport元を差し替えてください。</p> <div class="language-tsx extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token string">'./App.css'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Note <span class="token keyword">from</span> <span class="token string">'./NewNote'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>App-header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Component&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Hoge&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Note</span></span> <span class="token attr-name">word</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token string">&quot;Huga&quot;</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre></div><p>今回はあくまでもUIコンポーネントの構造をクラスベースなものから関数ベースなものに差し替えただけなので、見た目上UIが変わっていないはずです。しかし関数型コンポーネントはクラスベースなコンポーネントの時と比べ、ライフサイクルが常に上から下に流れるようになったためコンポーネントとしてのライフサイクルが読みやすくなりました。</p> <h4 id="チェックポイント-6"><a href="#チェックポイント-6" class="header-anchor">#</a> チェックポイント</h4> <ul><li>React Hooksを利用してコンポーネントを実装した</li></ul> <h3 id="reactアプリケーションをデプロイする"><a href="#reactアプリケーションをデプロイする" class="header-anchor">#</a> Reactアプリケーションをデプロイする</h3> <p>さてこれまでは開発サーバーでReactを動かしてきました。実際にReactプロジェクトをビルドし、SPAをNGINXで配信してみましょう。</p> <p>💻 Reactプロジェクトをビルドします。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># プロジェクトルート上でビルドします</span>
❯ <span class="token function">npm</span> run build
<span class="token comment"># 成果物があることを確認します</span>
❯ <span class="token function">ls</span> build/
asset-manifest.json  index.html   logo512.png    robots.txt
favicon.ico          logo192.png  manifest.json  static
</code></pre></div><p>💻 成果物をホストマシンにコピーしてきます</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 成果物を適当なディレクトリにコピーしてきます</span>
$ docker <span class="token function">cp</span> bootcamp-react:/app/build ./
</code></pre></div><p>💻 nginx上にSPAをデプロイ</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># buildディレクトリをそのままマウント</span>
$ docker run --rm -d -p <span class="token number">9000</span>:80 --name react-prod -v <span class="token variable">${<span class="token environment constant">PWD</span>}</span>/build/:/usr/share/nginx/html/ nginx:latest
</code></pre></div><p>以降ホストマシン側の<a href="http://localhost:9000" target="_blank" rel="noopener noreferrer">localhost:9000<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>へアクセスすると、先ほど作成したSPAが画面に表示されているはずです。</p> <h1 id="最後に"><a href="#最後に" class="header-anchor">#</a> 最後に</h1> <p>以上でReactのハンズオンは終了です。</p> <p>昨今のフロントエンド界隈は比較的落ち着いてきた(=デファクトが固まりつつある)印象がありますが、それでも変化の早い世界です。この文書も、いつ時代遅れになるかもわかりません。</p> <p>ですが、フロントエンドはアプリケーションの花形です。ぜひフロントエンドの知見を日々広げ、花形の開発者として活躍してもらえればうれしいです。</p> <div><hr> <span>CC BY-SA Licensed | Copyright (c) 2020, Internet Initiative Japan Inc.</span></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/iij/bootcamp/edit/master/src/frontend/react/README.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/16/2021, 2:16:50 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/bootcamp/assets/js/app.62a3d345.js" defer></script><script src="/bootcamp/assets/js/2.f590af91.js" defer></script><script src="/bootcamp/assets/js/9.2792b898.js" defer></script><script src="/bootcamp/assets/js/13.84557f0a.js" defer></script><script src="/bootcamp/assets/js/12.3f056208.js" defer></script>
  </body>
</html>
