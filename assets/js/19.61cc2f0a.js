(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{424:function(s,t,a){"use strict";a.r(t);var n=a(42),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"database-redis-編"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#database-redis-編"}},[s._v("#")]),s._v(" Database: Redis 編")]),s._v(" "),a("p",[s._v("このハンズオンの狙い")]),s._v(" "),a("ul",[a("li",[s._v("Docker に慣れる")]),s._v(" "),a("li",[s._v("Redis を実際に使ってみる")]),s._v(" "),a("li",[s._v("よく使いたくなる処理(部品)を作ってみる")])]),s._v(" "),a("h2",{attrs:{id:"事前準備"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事前準備"}},[s._v("#")]),s._v(" 事前準備")]),s._v(" "),a("ul",[a("li",[s._v("Docker を使用できる\n"),a("ul",[a("li",[s._v("install は主題ではないので、Docker image を使用します")])])]),s._v(" "),a("li",[s._v("何らかの LL を使える\n"),a("ul",[a("li",[s._v("例は Python で書きますが、Ruby, Perl, JavaScript, Go なども使えます。適当に読み替えてください")])])])]),s._v(" "),a("h3",{attrs:{id:"事前準備手順"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事前準備手順"}},[s._v("#")]),s._v(" 事前準備手順")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("Redis と Python のイメージを使えるようにする")]),s._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker pull redis:5\ndocker pull python:3.7\ndocker pull python:3.7.8-alpine3.12\ndocker images\n\nREPOSITORY                     TAG                 IMAGE ID            CREATED             SIZE\ndocker.io/python               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v(".8-alpine3.12    6ca3e0b1ab69        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" weeks ago         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("73.1")]),s._v(" MB\npython                         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v("                 4c0fd7901be8        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v(" hours ago        929MB\nredis                          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("                   bb0ab8a99fe6        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" days ago          95MB\n")])])])]),s._v(" "),a("li",[a("p",[s._v("サーバを起動する")]),s._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker run --rm --name test-server redis:5\n")])])])]),s._v(" "),a("li",[a("p",[s._v("別のターミナルを開いて、redis-cli でサーバに接続してみる")]),s._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker run -it --link test-server:redis --rm redis:5 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'exec redis-cli -h \""),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$REDIS_PORT_6379_TCP_ADDR")]),s._v('" -p "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$REDIS_PORT_6379_TCP_PORT")]),s._v("\"'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ping")]),s._v("\nPONG\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n")])])]),a("ul",[a("li",[s._v("Windows 環境は Git Bash の MINGW64 環境で動作確認しました\n"),a("ul",[a("li",[s._v("winpty docker -it 〜 としたらいけました")])])])])]),s._v(" "),a("li",[a("p",[s._v("(最初に起動した Redis サーバは C-c とめられます)")])]),s._v(" "),a("li",[a("p",[s._v("Python Clientから接続用のReidsサーバを起動する")]),s._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker run -d --rm --name test-server -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 redis:5\n")])])])]),s._v(" "),a("li",[a("p",[s._v("さらに別のターミナルを開いて、Pythonが使えるコンテナイメージを展開する")]),s._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v(" docker run -it python:3.7.8-alpine3.12 ash\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pip3 install redis")]),s._v("\nCollecting redis\nDownloading redis-3.5.3-py2.py3-none-any.whl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("72")]),s._v(" kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51")]),s._v(" kB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.0")]),s._v(" MB/s eta "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("     \n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓     \n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓\n "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓〓"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("72")]),s._v(" kB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("747")]),s._v(" kB/s \nInstalling collected packages: redis\nSuccessfully installed redis-3.5.3\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# python3")]),s._v("\nPython "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v(".8 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default, Jun "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":02:38"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GCC "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.3")]),s._v(".0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" on linux\nType "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"help"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"copyright"')]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"credits"')]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"license"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" information.\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" redis\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" conn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" redis.StrictRedis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'172.17.0.1'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n// 複数データセット: mset コマンド\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.mset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key1'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value1'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key2'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nTrue\n\n// 複数データゲット: mget コマンド\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" values "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.mget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key1'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value1'")]),s._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n// 複数データセット,ゲットを別手法でやってみる "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" mset,mget,scan コマンド\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" keys "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.scan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("match"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" values_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.mget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("values_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value1'")]),s._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.mset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key1'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value1'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key2'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value2'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'id1'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ichiro'")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'id2'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'jiro'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  // データ追加して\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" keys "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.scan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("match"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" values_1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.mget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("values_1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value1'")]),s._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" keys "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.scan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("match"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'id*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" all_id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.mget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("all_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ichiro'")]),s._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'jiro'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n// 複数データ削除: delete コマンド\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" _, keys "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.scan"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("match"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'key*'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("conn.mget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value1'")]),s._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" conn.delete"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("*keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("conn.mget"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("None, None"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" print"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("all_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ichiro'")]),s._v(", b"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'jiro'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  \n")])])]),a("ul",[a("li",[s._v("Windows 環境は Git Bash の MINGW64 環境で動作確認しました\n"),a("ul",[a("li",[s._v("winpty docker -it 〜 としたらいけました")])])])])]),s._v(" "),a("li",[a("p",[s._v("(最初に起動した Redis サーバは C-c で止められます)")])]),s._v(" "),a("li",[a("p",[s._v("参考: Redisを使ったGeospatial")]),s._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("test-server:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" GEOADD sample-loc "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("139.700258")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.690921")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shinjuku-station"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ntest-server:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" GEOADD sample-loc "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("139.70121502876282")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.69271580036533")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shinjuku-alta"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ntest-server:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" GEOADD sample-loc "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("139.69163417816162")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.68947430993086")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tocho"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("integer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ntest-server:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" GEORADIUS sample-loc "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("139.700258")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35.690921")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" m\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shinjuku-station"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shinjuku-alta"')]),s._v("\ntest-server:637"),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" GEODIST sample-loc shinjuku-station tocho\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"795.2182"')]),s._v("\n")])])])])]),s._v(" "),a("h2",{attrs:{id:"あらすじ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#あらすじ"}},[s._v("#")]),s._v(" あらすじ")]),s._v(" "),a("ul",[a("li",[s._v("Redis ざっくり説明")]),s._v(" "),a("li",[s._v("Redis を直接触ってみよう")]),s._v(" "),a("li",[s._v("プログラムで DB 登録しよう")]),s._v(" "),a("li",[s._v("応用課題")])]),s._v(" "),a("h2",{attrs:{id:"資料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#資料"}},[s._v("#")]),s._v(" 資料")]),s._v(" "),a("h3",{attrs:{id:"redis-とは何か"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis-とは何か"}},[s._v("#")]),s._v(" Redis とは何か")]),s._v(" "),a("ul",[a("li",[s._v("KVS の一種\n"),a("ul",[a("li",[s._v("LAMP (Linux, Apache, MySQL, PHP/Perl/Python) と言ってたけど…")]),s._v(" "),a("li",[s._v("RDB はたいていの Web サービスにはリッチすぎる")])])]),s._v(" "),a("li",[s._v("オンメモリで動作し、速い\n"),a("ul",[a("li",[s._v("設定で永続化やクラスタリングもできる")])])]),s._v(" "),a("li",[s._v("便利な機能やデータ型がある\n"),a("ul",[a("li",[s._v("string, list, set, sorted set, hash, (bitmap, HLL, pubsub, streaming)")]),s._v(" "),a("li",[s._v("expire")])])]),s._v(" "),a("li",[s._v("世間での使用例\n"),a("ul",[a("li",[s._v("Web server のセッション保持")]),s._v(" "),a("li",[s._v("高速にアクセスしたいメタデータの保持")]),s._v(" "),a("li",[s._v("コンテンツ/データのキャッシュ")]),s._v(" "),a("li",[s._v("データの一時キュー")]),s._v(" "),a("li",[s._v("sorted set 型によるランキング")]),s._v(" "),a("li",[s._v("set 型によるタグ付けと集合演算")])])])]),s._v(" "),a("h3",{attrs:{id:"redis-を直接触ってみよう"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis-を直接触ってみよう"}},[s._v("#")]),s._v(" Redis を直接触ってみよう")]),s._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://redis.io/commands",target:"_blank",rel:"noopener noreferrer"}},[s._v("Redis コマンド一覧"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[s._v("データベースの選択")]),s._v(" "),a("ul",[a("li",[s._v("select")]),s._v(" "),a("li",[s._v("info")]),s._v(" "),a("li",[s._v("dbsize")])])]),s._v(" "),a("li",[a("p",[s._v("基本操作と文字列型")]),s._v(" "),a("ul",[a("li",[s._v("set/get")]),s._v(" "),a("li",[s._v("キーの操作\n"),a("ul",[a("li",[s._v("keys")]),s._v(" "),a("li",[s._v("exists")]),s._v(" "),a("li",[s._v("del/unlink/rename/renamenx")])])]),s._v(" "),a("li",[s._v("incr/decr/incrby/decrby")]),s._v(" "),a("li",[s._v("mset/mget")]),s._v(" "),a("li",[s._v("getset")]),s._v(" "),a("li",[s._v("setnx")])])]),s._v(" "),a("li",[a("p",[s._v("expiration")]),s._v(" "),a("ul",[a("li",[s._v("expire/expireat/persist")]),s._v(" "),a("li",[s._v("ttl/pttl")]),s._v(" "),a("li",[s._v("set/setex")])])])]),s._v(" "),a("h3",{attrs:{id:"プログラムから-redis-を使おう"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#プログラムから-redis-を使おう"}},[s._v("#")]),s._v(" プログラムから Redis を使おう")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("手元の適当なディレクトリに (Python の) スクリプトを作成します。仮に ~/app ディレクトリを使うとします")]),s._v(" "),a("ul",[a("li",[s._v("Python から Redis を扱うためのライブラリ "),a("a",{attrs:{href:"https://github.com/andymccurdy/redis-py",target:"_blank",rel:"noopener noreferrer"}},[s._v("Redis Python Client"),a("OutboundLink")],1),s._v(" を pip でインストールする")])]),s._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker run -it --link test-server:redis --rm --name test-python -v ~/app:/app python:3.7 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\nroot@24108149af23:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd app")]),s._v("\nroot@24108149af23:/app"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pip install redis")]),s._v("\nCollecting redis\n  Downloading https://files.pythonhosted.org/packages/ac/a7/cff10cc5f1180834a3ed564d148fb4329c989cbb1f2e196fc9a10fa07072/redis-3.2.1-py2.py3-none-any.whl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("65kB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("████████████████████████████████"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 71kB "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".2MB/s\nInstalling collected packages: redis\nSuccessfully installed redis-3.2.1\nroot@24108149af23:/app"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# env | grep REDIS")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_PORT_6379_TCP_PROTO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tcp\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_PORT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tcp://172.17.0.2:6379\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/test-python/redis\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_PORT_6379_TCP_ADDR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_PORT_6379_TCP")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tcp://172.17.0.2:6379\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_ENV_REDIS_DOWNLOAD_URL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://download.redis.io/releases/redis-5.0.5.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_PORT_6379_TCP_PORT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_ENV_REDIS_DOWNLOAD_SHA")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("2139009799d21d8ff94fc40b7f36ac46699b9e1254086299f8d3b223ca54a375\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_ENV_GOSU_VERSION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.10")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("REDIS_ENV_REDIS_VERSION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v(".5\nroot@24108149af23:/app"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("~/app ディレクトリにプログラムを作って、上記の Shell で実行してみましょう。")])])]),s._v(" "),a("h4",{attrs:{id:"要素を入れてみる"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#要素を入れてみる"}},[s._v("#")]),s._v(" 要素を入れてみる")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("普通に List や Hash として使って、適当に要素を入れてみよう")]),s._v(" "),a("ul",[a("li",[s._v("/etc/services の ポート -> プロトコル名称 対応表を作る")])]),s._v(" "),a("div",{staticClass:"language-Python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1/tcp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tcpmux'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'7/tcp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'7/udp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'9/tcp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'discard'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sink'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'null'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'9/udp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'discard'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sink'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'null'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'11/tcp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'systat'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'users'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("ul",[a("li",[s._v("/etc/passwd の内容をユーザごとのハッシュに格納する")])]),s._v(" "),a("div",{staticClass:"language-Python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'passwd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'x'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'uid'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gid'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'shell'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/bin/bash'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'daemon'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'passwd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'x'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'uid'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gid'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'daemon'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'home'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/usr/sbin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'shell'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/usr/sbin/nologin'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])])]),s._v(" "),a("h3",{attrs:{id:"expire-を試してみる"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#expire-を試してみる"}},[s._v("#")]),s._v(" Expire を試してみる")]),s._v(" "),a("ul",[a("li",[s._v("expire 付きで値を格納し、実際にその時間が過ぎると値が消えていくことを確認する")])]),s._v(" "),a("h3",{attrs:{id:"メッセージキューを実装する"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#メッセージキューを実装する"}},[s._v("#")]),s._v(" メッセージキューを実装する")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("メッセージキュー的なものを実装してみよう")]),s._v(" "),a("ul",[a("li",[s._v("依頼側: ランダム秒 sleep して、メッセージをキューに入れる")]),s._v(" "),a("li",[s._v("取り出し側: ランダム秒 sleep して、メッセージをキューから取り出す")])])]),s._v(" "),a("li",[a("p",[s._v("使用例: web クローラー")]),s._v(" "),a("ul",[a("li",[s._v("依頼側: URL をどんどんキューに入れる")]),s._v(" "),a("li",[s._v("取り出し側: キューを見て URL が入っていたら、取得してファイルに保存する\n"),a("ul",[a("li",[s._v("結果(ファイルの場所)を別のキューで戻してもいいですね")])])])])])]),s._v(" "),a("h3",{attrs:{id:"advanced-redis-pub-sub-streams-を使ってみよう"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#advanced-redis-pub-sub-streams-を使ってみよう"}},[s._v("#")]),s._v(" Advanced: Redis Pub/Sub, Streams を使ってみよう")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://redis.io/topics/pubsub",target:"_blank",rel:"noopener noreferrer"}},[s._v("Pub/Sub"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://redis.io/topics/streams-intro",target:"_blank",rel:"noopener noreferrer"}},[s._v("Introduction to Redis Streams"),a("OutboundLink")],1)])]),s._v(" "),a("h3",{attrs:{id:"advanced-jupyter-notebook-イメージを使ってみよう"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#advanced-jupyter-notebook-イメージを使ってみよう"}},[s._v("#")]),s._v(" Advanced: Jupyter notebook イメージを使ってみよう")]),s._v(" "),a("div",{staticClass:"language-Shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("docker pull jupyter/base-notebook\ndocker run --rm --link test-server:redis -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":8888 -v ~/app:/home/jovyan/work jupyter/base-notebook\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# メッセージを見て、ブラウザから localhost:8888 に接続する")]),s._v("\n")])])]),a("h2",{attrs:{id:"参考資料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考資料"}},[s._v("#")]),s._v(" 参考資料")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://redis.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Redis 本家"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/andymccurdy/redis-py",target:"_blank",rel:"noopener noreferrer"}},[s._v("Redis Python Client"),a("OutboundLink")],1)])]),s._v(" "),a("credit-footer")],1)}),[],!1,null,null,null);t.default=e.exports}}]);