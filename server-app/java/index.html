<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java; springboot | IIJ Bootcamp</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="SpringBootを使ったアプリ開発を試してみるハンズオンです">
    
    <link rel="preload" href="/bootcamp/assets/css/0.styles.a3856d16.css" as="style"><link rel="preload" href="/bootcamp/assets/js/app.c512e039.js" as="script"><link rel="preload" href="/bootcamp/assets/js/2.f4bad7c4.js" as="script"><link rel="preload" href="/bootcamp/assets/js/23.df2b5170.js" as="script"><link rel="preload" href="/bootcamp/assets/js/11.9b671749.js" as="script"><link rel="preload" href="/bootcamp/assets/js/10.d0e8d2eb.js" as="script"><link rel="prefetch" href="/bootcamp/assets/js/12.d59dd6ad.js"><link rel="prefetch" href="/bootcamp/assets/js/13.f7854e31.js"><link rel="prefetch" href="/bootcamp/assets/js/14.f72b025c.js"><link rel="prefetch" href="/bootcamp/assets/js/15.ce9d6e12.js"><link rel="prefetch" href="/bootcamp/assets/js/16.370acae5.js"><link rel="prefetch" href="/bootcamp/assets/js/17.a914052f.js"><link rel="prefetch" href="/bootcamp/assets/js/18.cafc696a.js"><link rel="prefetch" href="/bootcamp/assets/js/19.a39c1f01.js"><link rel="prefetch" href="/bootcamp/assets/js/20.4dda5cee.js"><link rel="prefetch" href="/bootcamp/assets/js/21.8f1b9835.js"><link rel="prefetch" href="/bootcamp/assets/js/22.61211d92.js"><link rel="prefetch" href="/bootcamp/assets/js/24.52328e4a.js"><link rel="prefetch" href="/bootcamp/assets/js/25.f5c88938.js"><link rel="prefetch" href="/bootcamp/assets/js/26.17e3fe7d.js"><link rel="prefetch" href="/bootcamp/assets/js/27.aa1aa3f4.js"><link rel="prefetch" href="/bootcamp/assets/js/28.9d3d6289.js"><link rel="prefetch" href="/bootcamp/assets/js/29.f614c249.js"><link rel="prefetch" href="/bootcamp/assets/js/3.e32875d3.js"><link rel="prefetch" href="/bootcamp/assets/js/30.fe0009db.js"><link rel="prefetch" href="/bootcamp/assets/js/31.c6645c9a.js"><link rel="prefetch" href="/bootcamp/assets/js/32.a44fab55.js"><link rel="prefetch" href="/bootcamp/assets/js/33.5a408bd9.js"><link rel="prefetch" href="/bootcamp/assets/js/34.0420c361.js"><link rel="prefetch" href="/bootcamp/assets/js/35.a23c82cd.js"><link rel="prefetch" href="/bootcamp/assets/js/36.b73dda7b.js"><link rel="prefetch" href="/bootcamp/assets/js/37.f9b4bf1f.js"><link rel="prefetch" href="/bootcamp/assets/js/38.d3f64fb9.js"><link rel="prefetch" href="/bootcamp/assets/js/39.c578aa4e.js"><link rel="prefetch" href="/bootcamp/assets/js/4.b4033434.js"><link rel="prefetch" href="/bootcamp/assets/js/40.629ce2e4.js"><link rel="prefetch" href="/bootcamp/assets/js/41.bba1d2a6.js"><link rel="prefetch" href="/bootcamp/assets/js/42.f1a1323a.js"><link rel="prefetch" href="/bootcamp/assets/js/43.39cfbaab.js"><link rel="prefetch" href="/bootcamp/assets/js/44.c34afb79.js"><link rel="prefetch" href="/bootcamp/assets/js/45.1c379f4c.js"><link rel="prefetch" href="/bootcamp/assets/js/46.0bffe727.js"><link rel="prefetch" href="/bootcamp/assets/js/47.b4e45f95.js"><link rel="prefetch" href="/bootcamp/assets/js/48.e02dbfa1.js"><link rel="prefetch" href="/bootcamp/assets/js/49.1aab99a7.js"><link rel="prefetch" href="/bootcamp/assets/js/5.bda81e20.js"><link rel="prefetch" href="/bootcamp/assets/js/6.0abc1e58.js"><link rel="prefetch" href="/bootcamp/assets/js/7.ebba0d58.js"><link rel="prefetch" href="/bootcamp/assets/js/8.2af9b0ff.js"><link rel="prefetch" href="/bootcamp/assets/js/9.c6cd00b9.js">
    <link rel="stylesheet" href="/bootcamp/assets/css/0.styles.a3856d16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/bootcamp/" class="home-link router-link-active"><!----> <span class="site-name">IIJ Bootcamp</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/iij/bootcamp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/iij/bootcamp" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java; springboot</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bootcamp/server-app/java/#始めに" class="sidebar-link">始めに</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/server-app/java/#下準備" class="sidebar-link">下準備</a></li><li class="sidebar-sub-header"><a href="/bootcamp/server-app/java/#java-について" class="sidebar-link">java について</a></li></ul></li><li><a href="/bootcamp/server-app/java/#springboot-bootcamp" class="sidebar-link">SpringBoot Bootcamp</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/server-app/java/#初回起動チェック" class="sidebar-link">初回起動チェック</a></li><li class="sidebar-sub-header"><a href="/bootcamp/server-app/java/#di-について" class="sidebar-link">DI について</a></li></ul></li><li><a href="/bootcamp/server-app/java/#本編" class="sidebar-link">本編</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/server-app/java/#コントローラを作成してみましょう" class="sidebar-link">コントローラを作成してみましょう</a></li><li class="sidebar-sub-header"><a href="/bootcamp/server-app/java/#演習-生徒管理の-api-を作成しよう" class="sidebar-link">演習：生徒管理の API を作成しよう</a></li></ul></li><li><a href="/bootcamp/server-app/java/#演習-生徒管理の-api-を実装してみましょう" class="sidebar-link">演習：生徒管理の API を実装してみましょう！</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/bootcamp/server-app/java/#最後に" class="sidebar-link">最後に</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/bootcamp/server-app/java/#追加の資料" class="sidebar-link">追加の資料</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><table><tr><td>このハンズオンでやること</td><td>SpringBootを使ったアプリ開発を試してみるハンズオンです</td></tr> <tr><td>想定時間</td><td>2h</td></tr> <tr><td>前提知識・用語</td><td>特になし</td></tr></table> <h1 id="page-frontmatter-title"><a href="#page-frontmatter-title" class="header-anchor">#</a> Java; springboot</h1> <p>IIJ Bootcamp java; SpringBoot に関する資料です。あらかじめ Bootcamp のリポジトリをローカルへ clone し、下準備まで終わらせておいてください。</p> <blockquote><p>git clone <a href="https://github.com/iij/bootcamp.git" target="_blank" rel="noopener noreferrer">https://github.com/iij/bootcamp.git<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>cd src/server-app/java/</p></blockquote> <h2 id="始めに"><a href="#始めに" class="header-anchor">#</a> 始めに</h2> <p>この Bootcamp では Java を利用して SpringBoot の表面的な機能をさらっていくことを目標としています。</p> <p>具体的には、下記を達成できるようになることを期待しています。</p> <ul><li>&quot;API サーバ&quot;の概念を知る</li> <li>今後、SpringBoot のプロジェクトに参加した際のキャッチアップの短縮</li> <li>簡単な テスト用の API モックサーバの作成、メンテナンスができるようになる</li></ul> <h3 id="下準備"><a href="#下準備" class="header-anchor">#</a> 下準備</h3> <p>下準備として、Docker の動作確認と IDE の設定などを行っておいてください。Java イメージや依存関係などのダウンロードを行うので、安定したネットワーク環境下で実行することをお勧めします。</p> <p>詳細 &gt; <a href="/bootcamp/server-app/java/prepare.html">下準備・環境構築編</a></p> <h3 id="java-について"><a href="#java-について" class="header-anchor">#</a> java について</h3> <p>この Bootcamp では Java と Gradle を利用します。しかし Bootcamp の場でそれぞれについて深く解説する時間は取れないため、Bootcamp を進めるうえで最低限知っておくべき知識について下記に記載しておきました。</p> <p>詳細 &gt; <a href="/bootcamp/server-app/java/java.html">bootcamp/java</a></p> <h2 id="springboot-bootcamp"><a href="#springboot-bootcamp" class="header-anchor">#</a> SpringBoot Bootcamp</h2> <p>SprinbBoot はいまや Java 界隈最大手の Web フレームワークです。小規模なブログから大規模な EC サイトまでこのフレームワークだけで開発、デプロイできます。</p> <p>このフレームワークを開発するうえで、基本的な Java の知識や DI といった設計の知識も必要になってきます。残念ながらこの Bootcamp ですべての要素に触れることはできませんが、最初の入り口に立つところまでを案内します。今回はブラウザで閲覧できる UI の機能を持たず、 API(Application Programming Interface)の機能だけを持つ API サーバを構築していきます。</p> <p>それでは始めましょう。</p> <h3 id="初回起動チェック"><a href="#初回起動チェック" class="header-anchor">#</a> 初回起動チェック</h3> <p><a href="/bootcamp/server-app/java/prepare.html">事前準備・環境構築編</a> を終えた状態になっていることを確認します。ホストマシンのブラウザから<a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>にアクセスすると下記のエラー画面が出る状態になっていることを確認してください。</p> <p><img src="/bootcamp/assets/img/white-label-error.c9ee4513.png" alt="初回起動 - WhitelabelErrorPage"></p> <p>チェックポイント</p> <ul><li><a href="/bootcamp/server-app/java/prepare.html">事前準備・環境構築編</a> を一読し、完了した。</li> <li><a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">localhost:8080<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>にアクセスして Whitelabel Error Page が表示される。</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>SpringBoot のプロジェクトは&quot;Spring Initializr&quot;というツールを使ってひな型を作成できます。</p> <p><a href="https://start.spring.io/#!type=gradle-project&amp;language=java&amp;platformVersion=2.4.0.BUILD-SNAPSHOT&amp;packaging=jar&amp;jvmVersion=11&amp;groupId=com.example&amp;artifactId=demo&amp;name=demo&amp;description=Demo%20project%20for%20Spring%20Boot&amp;packageName=com.example.demo&amp;dependencies=web" target="_blank" rel="noopener noreferrer">Spring Initializr<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>今回提供している/app 配下の Java プロジェクトは上記から作成したひな型に<code>com.example.demo.controller.DemoController.java</code>を追加しただけのプロジェクトです。</p></div> <h3 id="di-について"><a href="#di-について" class="header-anchor">#</a> DI について</h3> <p>SpringBoot を使いこなすためには DI について触れなくてはいけません。なぜなら、SpringBoot でコントローラを作成するときや依存関係を書いたりする際に DI の機能を用いるからです。</p> <p>が、DI について深く記すには余白が狭すぎるためこの場では詳細な説明を省くことにします。詳しくはこちらを参照してみてください。 &gt; <a href="/bootcamp/server-app/java/DI.html">DI #とは</a></p> <p>チェックポイント</p> <ul><li>SpringBoot では DI という概念が重要であることを理解した。</li></ul> <h2 id="本編"><a href="#本編" class="header-anchor">#</a> 本編</h2> <h3 id="コントローラを作成してみましょう"><a href="#コントローラを作成してみましょう" class="header-anchor">#</a> コントローラを作成してみましょう</h3> <p>まず始めに簡単な Helloworld を行うコントローラを作成し、SpringBoot がどのように動作しているのかを見てみましょう。
それではさっそくコードを書いていきます。</p> <blockquote><p>src/main/java/com/example/demo/DemoApplication.java</p></blockquote> <p>上記のクラスに下記の通り追記してみましょう。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>
<span class="token comment">// 追記BEGIN</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>
<span class="token comment">// 追記END</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DemoApplication</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">DemoApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 追記BEGIN</span>
  <span class="token annotation punctuation">@RestController</span>
  <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">helloWorld</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 追記END</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ここまで書いたら、再びアプリケーションを再起動してあげましょう！</p> <div class="language-bash extra-class"><pre class="language-bash"><code>./gradlew bootRun
<span class="token function">curl</span> localhost:8080
</code></pre></div><p>&quot;hello world&quot;が返ってきたら成功です。</p> <p>さて、この 10 行に満たないコードを書いている間に何が起きたのかを簡単に解説します。</p> <p><code>bootRun</code> コマンドにより SprinbBoot が起動します。すると、SpringBoot の機能により <code>RestController</code> アノテーションが付いている <code>DemoApplication.HelloController</code> が HTTP のインタフェースとして登録されます。</p> <p>その結果、この SpringBoot が動いている 8080 番ポート宛の HTTP リクエストと <code>DemoApplication.HelloController#helloWorld</code> が紐づけられることになり、GET / のリクエストのレスポンスが&quot;hello world&quot;になったわけです。</p> <p>チェックポイント</p> <ul><li>SpringBoot で HelloWorld ができた</li> <li>RestController アノテーションをクラスに付けることでコントローラが作れることを理解した</li></ul> <h4 id="蛇足-springboot-の-di-コンテナと探索"><a href="#蛇足-springboot-の-di-コンテナと探索" class="header-anchor">#</a> 蛇足 : SpringBoot の DI コンテナと探索</h4> <p>SpringBoot は <code>SpringBootApplication</code> アノテーションのついたクラスの <code>main</code> 関数を起動することで動きます。起動すると、SpringBoot は起動クラスのパッケージ配下の Java ファイルから Contoroller/Component/...といった特殊なアノテーションがついたクラスを探し出します。</p> <p>そして SpringBoot はそのクラスを適当な方法でインスタンス化し、自身の管理下(=DI コンテナ)に置きます。</p> <p>(「適当な方法」を指定することもできます &gt; <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/Bean.html" target="_blank" rel="noopener noreferrer">Bean Annotation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>)</p> <p>この時、「Controller」「RestController」アノテーションが付与されたクラスから生成されたインスタンスは HTTP のインタフェースとして働くことになります。</p> <p>今回の例では、 <code>DemoApplication</code> クラスに SpringBootApplication アノテーションが付与されているので <code>DemoApplication</code> クラスのパッケージ <code>com.example.demo</code> 配下のクラスから特殊なアノテーションがついているクラスを探索します。</p> <p>先ほど作成した <code>HelloController</code> は、 <code>RestController</code> アノテーションが付与されていたため SpringBoot が <code>HelloController</code> をインスタンス化、DI コンテナに登録しました。
そして / 宛の GET のリクエストを受けると <code>HelloController#helloWorld</code> が実行されるようになっていた、というわけです。</p> <h3 id="演習-生徒管理の-api-を作成しよう"><a href="#演習-生徒管理の-api-を作成しよう" class="header-anchor">#</a> 演習：生徒管理の API を作成しよう</h3> <p>それでは、下記の機能を持つ REST API を作成してみましょう！</p> <p>生徒管理 API の作成の依頼</p> <blockquote><p>あなたは、あるプログラミングスクールでテストのスコアを管理するアプリケーションの製造を依頼されました。フロントエンドのアプリケーションは実装済みで、<a href="https://ja.wikipedia.org/wiki/%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E3%82%A4%E3%83%B3%E3%82%BF%E3%83%95%E3%82%A7%E3%83%BC%E3%82%B9" target="_blank" rel="noopener noreferrer">API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> サーバが必要とのことです。そこで、あなたは下記の機能を持った API サーバを製造することになりました。</p> <ul><li>GET
<ul><li>/students 保存済みの全生徒エンティティを返却する</li></ul></li> <li>GET
<ul><li>/students/{生徒 ID} 指定された生徒 ID を持つ生徒エンティティを返却する</li></ul></li> <li>POST
<ul><li>/students 指定されたプロパティを持つ生徒エンティティを保存し、保存した生徒エンティティを返却する</li></ul></li> <li>PUT
<ul><li>/students{生徒 ID} 指定されたプロパティを持つ生徒エンティティを変更し、変更後の生徒エンティティを返却する</li></ul></li></ul> <p>※ 生徒エンティティには「生徒 ID」「生徒名」「成績(整数)」を含むものとする</p> <p>※ このように HTTP のメソッドをリソースの操作、URL をリソースの指定に使う API のことを RESTfulAPI を呼びます</p></blockquote> <p>まず、下記のクラスに <code>RestController</code> アノテーションを追加します。
また <code>StudentController#retrieveStudents</code> に GET /students のエンドポイントとの紐付けを作成してみます。</p> <blockquote><p>src/main/java/com/example/demo/controller/StudentController.java</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 生徒エンティティのCRUD APIエンドポイント
 *
 * TODO 適切なアノテーションを付与してRESTのコントローラーにする
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StudentController</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 登録されている生徒エンティティを全て返却する
     *
     * TODO 適切なアノテーションを付与してGET /studentでHTTPを受け取れるようにする
     * TODO 適切な返却の型を指定する
     * TODO 内部ロジックを書く
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/students&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">retrieveStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hi&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// snip</span>
<span class="token punctuation">}</span>
</code></pre></div><p>再度 bootRun コマンドで起動し、正しく動作していることを確認しましょう。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> localhost:8080/students
<span class="token operator">&gt;</span> hi
</code></pre></div><p>チェックポイント</p> <ul><li>空のクラスに<code>RestController</code>アノテーションを付与して、コントローラとして起動できた</li> <li>API のエンドポイントのパスの設定方法を理解した</li></ul> <h4 id="オブジェクトを返却する"><a href="#オブジェクトを返却する" class="header-anchor">#</a> オブジェクトを返却する</h4> <p>今までコントローラが返却していたのは文字列だけでしたが、場合によっては Json などのオブジェクトを返却したいこともあると思います。特に今回は生徒エンティティを返却するように言われているため、まずは生徒エンティティを作成しましょう。</p> <blockquote><p>src/main/java/com/example/demo/entity/StudentEntity.java</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 生徒Entity
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StudentEntity</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 生徒ID
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> studentId<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 生徒名
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 成績
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> score<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getStudentId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> studentId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setStudentId</span><span class="token punctuation">(</span><span class="token class-name">String</span> studentId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>studentId <span class="token operator">=</span> studentId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> score<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setScore</span><span class="token punctuation">(</span><span class="token keyword">long</span> score<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>RestController</code>で Json を返却する場合、多くの場合は POJO(純粋な java オブジェクト)をそのまま返却するだけで良いです。</p> <p>試しに先程作った <code>StudentEntity</code> をインスタンス化して返却してみましょう。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">StudentEntity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 生徒エンティティのCRUD APIエンドポイント
 *
 * TODO 適切なアノテーションを付与してRESTのコントローラーにする
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StudentController</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 登録されている生徒エンティティを全て返却する
     *
     * TODO 適切なアノテーションを付与してGET /studentでHTTPを受け取れるようにする
     * TODO 適切な返却の型を指定する ← DONE
     * TODO 内部ロジックを書く
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/students&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">StudentEntity</span> <span class="token function">retrieveStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> studentEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StudentEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setStudentId</span><span class="token punctuation">(</span><span class="token string">&quot;studentId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> studentEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// snip</span>
</code></pre></div><p>bootRun して動作していることを確認しましょう。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> localhost:8080/students
<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token string">&quot;studentId&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;studentId&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;hello&quot;</span>,<span class="token string">&quot;score&quot;</span>:100<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>すでに別のフレームワークを経験したことのある人であれば「Serializer は？」と感じる人もいるかもしれません。しかし SpringBoot では Serializer を意識する必要はないように作られています。もちろん自分でシリアライズ・デシリアライズを指定/実装することもできます。</p></div> <p>最後に retrieveStudents は「登録されているすべての生徒エンティティを返却」する関数ですので、List を返却するように変更しておきましょう。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">// snip</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/students&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StudentEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">retrieveStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> studentEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StudentEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setStudentId</span><span class="token punctuation">(</span><span class="token string">&quot;studentId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 追加 java.util.Listからimportするようにしましょう</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StudentEntity</span><span class="token punctuation">&gt;</span></span> entities <span class="token operator">=</span> <span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>studentEntity<span class="token punctuation">,</span> studentEntity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> entities<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// snip</span>
</code></pre></div><p>チェックポイント</p> <ul><li>Java の POJO に触れた</li> <li>API のエンドポイントからオブジェクトを返却する方法を理解した</li> <li>GET /students のエンドポイントのインタフェースが決定した</li></ul> <h4 id="パスパラメータから情報を受け取ろう"><a href="#パスパラメータから情報を受け取ろう" class="header-anchor">#</a> パスパラメータから情報を受け取ろう</h4> <p>次は特定の生徒を取得する API を作ってみましょう。</p> <p>URL のパスからパラメータをもらってくる場合、パスに変数名を埋め込みその変数を関数の引数として指定することでパスから値を引き抜いてくることができます。そのパスの変数のことをパスパラメータを呼びます。</p> <p>下記の通り実装して動作することを確認しましょう。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">StudentEntity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 生徒エンティティのCRUD APIエンドポイント
 *
 * TODO 適切なアノテーションを付与してRESTのコントローラーにする
 */</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StudentController</span> <span class="token punctuation">{</span>
    <span class="token comment">// snip</span>
    <span class="token comment">/**
     * 指定された生徒エンティティを返却する
     * TODO 適切なアノテーションを付与してGET /student/{id} でHTTPを受け取れるようにする
     * TODO 適切な返却の型を指定する
     * TODO 内部ロジックを書く
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/students/{studentId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">retrieveStudent</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> studentId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> studentId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// snip</span>
</code></pre></div><p>実装したら再度 bootRun して確認しましょう。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> localhost:8080/students/hello
<span class="token operator">&gt;</span> hello
</code></pre></div><p>先程と同様に適当な生徒エンティティを返却するように修正しておきましょう。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">// snip</span>
    <span class="token comment">/**
     * 指定された生徒エンティティを返却する
     * TODO 適切なアノテーションを付与してGET /student/{id} でHTTPを受け取れるようにする
     * TODO 適切な返却の型を指定する
     * TODO 内部ロジックを書く
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/students/{studentId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">StudentEntity</span> <span class="token function">retrieveStudent</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> studentId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> studentEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StudentEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setStudentId</span><span class="token punctuation">(</span>studentId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;hello2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> studentEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// snip</span>
</code></pre></div><p>チェックポイント</p> <ul><li>API のエンドポイントからパラメータを引き抜いてくる方法を理解した</li> <li>GET /student/{生徒 ID} のエンドポイントのインタフェースが決定した</li></ul> <h4 id="post-リクエストを受け取ってみよう"><a href="#post-リクエストを受け取ってみよう" class="header-anchor">#</a> POST リクエストを受け取ってみよう</h4> <p>ここまで作成した API は 2 つとも読み取り、GET メソッドでの実装でした。ここで POST リクエストを利用してデータを書き込む API を用意してあげましょう。</p> <p>POST リクエストを受け取るには、今まで使ってきた <code>GetMapping</code> の代わりに <code>PostMapping</code> を利用しましょう。また POST メソッドでのデータの受け渡しはリクエストボディで行うのが通例ですので、データをリクエストボディで受け取れるようにしましょう。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestBody</span><span class="token punctuation">;</span>

    <span class="token comment">// snip</span>
    <span class="token comment">/**
     * POST /student で受け取るリクエストボディのスキーマ
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">PostRequestBody</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Long</span> score<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> name<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> score<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setScore</span><span class="token punctuation">(</span><span class="token class-name">Long</span> score<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>score <span class="token operator">=</span> score<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 指定されたプロパティを持つ生徒エンティティを登録し、登録した生徒エンティティを返却する
     * TODO 適切なアノテーションを付与してPOST /student でHTTPを受け取れるようにする
     * TODO HTTPリクエストの際に受け取るリクエストの型を定義する
     * TODO 適切な返却の型を指定する
     * TODO 内部ロジックを書く
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/students&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">StudentEntity</span> <span class="token function">createStudent</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">PostRequestBody</span> body<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> studentEntity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StudentEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setStudentId</span><span class="token punctuation">(</span><span class="token string">&quot;studentId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        studentEntity<span class="token punctuation">.</span><span class="token function">setScore</span><span class="token punctuation">(</span>body<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> studentEntity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// snip</span>
</code></pre></div><p>再度 bootRun して動作を確認しましょう。</p> <div class="language- extra-class"><pre class="language-text"><code>curl -X POST localhost:8080/students -H 'Content-type: application/json' -d '{&quot;name&quot;: &quot;hello POST&quot;, &quot;score&quot;: 50}'
&gt; {&quot;studentId&quot;:&quot;studentId&quot;,&quot;name&quot;:&quot;hello POST&quot;,&quot;score&quot;:50}
</code></pre></div><p>チェックポイント</p> <ul><li>API のエンドポイントで POST リクエストを受け取る方法を理解した</li> <li>POST /student のエンドポイントのインタフェースが決定した</li></ul> <h4 id="業務処理を作ろう"><a href="#業務処理を作ろう" class="header-anchor">#</a> 業務処理を作ろう</h4> <p>コントローラ部分を作成したので、実際に生徒エンティティを管理するクラスを実装していきましょう。この Bootcamp では時間の都合上 RDS や KVS などを用いて永続化せず、ヒープメモリに保存するだけにします。</p> <p>下記の java ファイルを作成して、仮の実装をしましょう。</p> <blockquote><p>src/main/java/com/example/demo/service/StudentService.java</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">StudentEntity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StudentService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StudentEntity</span><span class="token punctuation">&gt;</span></span> savedStudents<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">StudentService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>savedStudents <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StudentEntity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 保存している生徒Entityを全て返却する
     * @return {@link StudentEntity}
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StudentEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">findStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>savedStudents<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * TODO 実装
    */</span>
    <span class="token keyword">public</span> <span class="token class-name">StudentEntity</span> <span class="token function">findStudentById</span><span class="token punctuation">(</span><span class="token class-name">String</span> studentId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * TODO 実装
    */</span>
    <span class="token keyword">public</span> <span class="token class-name">StudentEntity</span> <span class="token function">insertStudentEntity</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Long</span> score<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>@Component</code>は SpringBoot を開発する中で頻繁に利用するアノテーションです。このアノテーションが付与されたクラスは SpringBoot が起動するタイミングでインスタンス化され SpringBoot の管理下(=DI コンテナ)に配置されます。</p> <p><code>StudentService</code>は SpringBoot の管理下にいるため<code>StudentController</code>からアクセスできるようになりました。</p> <p>それではこの業務処理を行うクラスを<code>StudentController</code>に接続してあげましょう。</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token comment">// snip</span>

    <span class="token comment">// 追加する</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StudentService</span> studentService<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 登録されている生徒エンティティを全て返却する
     *
     * TODO 適切なアノテーションを付与してGET /studentでHTTPを受け取れるようにする
     * TODO 適切な返却の型を指定する
     * TODO 内部ロジックを書く
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>path <span class="token operator">=</span> <span class="token string">&quot;/students&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">StudentEntity</span><span class="token punctuation">&gt;</span></span> <span class="token function">retrieveStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> studentService<span class="token punctuation">.</span><span class="token function">findStudents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>接続の方法は簡単で、今回は<code>@Autowired</code>を利用しました。<code>@Autowired</code>が付与されたフィールドには SpringBoot が適切なインスタンスを自身の DI コンテナから配置してくれます。</p> <p>このため、<code>StudentController</code>は<code>StudentService</code>をインスタンス化する方法を知る必要なく<code>StudentService</code>を利用できるようになりました。</p> <p>再度 bootRun して動作を確認しましょう。</p> <p>チェックポイント</p> <ul><li>DI コンポーネントの作成の方法を理解した</li> <li>DI コンポーネントの利用方法を理解した</li></ul> <h2 id="演習-生徒管理の-api-を実装してみましょう"><a href="#演習-生徒管理の-api-を実装してみましょう" class="header-anchor">#</a> 演習：生徒管理の API を実装してみましょう！</h2> <p>ここまでのコンテンツで下記のことについて学びました。</p> <ul><li>Java の書き方</li> <li>API のエンドポイントの実装の方法</li> <li>API のスキーマ定義の方法</li> <li>DI コンポーネントの定義の方法</li> <li>@Autowired による DI の実現方法</li></ul> <p>これらを利用して、残りの API を自分で実装してみましょう。</p> <p>また、サンプルとして実装を終えたコードを用意しておきます。</p> <p><a href="https://github.com/RyuSA/student-app" target="_blank" rel="noopener noreferrer">https://github.com/RyuSA/student-app<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="最後に"><a href="#最後に" class="header-anchor">#</a> 最後に</h2> <p><s>いかがでしたか？</s> 以上で SpringBoot のハンズオンは終了です。</p> <p>この Bootcamp では SpringBoot の表面をさらっていくことを目的としたため、おそらくまだ全容をつかむことは難しいと思います。
ただ、今後の SpringBoot 習得の足掛かりとなれば幸いです。</p> <h3 id="追加の資料"><a href="#追加の資料" class="header-anchor">#</a> 追加の資料</h3> <ul><li><p><a href="https://spring.pleiades.io/spring-boot/docs/current/reference/html" target="_blank" rel="noopener noreferrer">Spring Boot リファレンスドキュメント<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>多くの SpringBoot 開発者がお世話になる公式ドキュメントです。アプリケーションの開発からデプロイ方法まで、幅広く情報が提供されています。</li></ul></li> <li><p><a href="https://spring.pleiades.io/guides" target="_blank" rel="noopener noreferrer">SpringBoot Guides<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>SpringBoot の各種機能を試してみるチュートリアルが公開されています。Pub/Sub や MongoDB、Docker との連携など SpringBoot の拡張が多種公開されています。興味のある項目に触ってみてください。</li></ul></li></ul> <div><hr> <span>CC BY-SA Licensed | Copyright (c) 2020, Internet Initiative Japan Inc.</span></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/iij/bootcamp/edit/master/src/server-app/java/README.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/3/2021, 1:26:06 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/bootcamp/assets/js/app.c512e039.js" defer></script><script src="/bootcamp/assets/js/2.f4bad7c4.js" defer></script><script src="/bootcamp/assets/js/23.df2b5170.js" defer></script><script src="/bootcamp/assets/js/11.9b671749.js" defer></script><script src="/bootcamp/assets/js/10.d0e8d2eb.js" defer></script>
  </body>
</html>
